<p-confirmDialog
    key='err'
    header="Error"
    icon="pi pi-exclamation-triangle"
    rejectVisible="false"
></p-confirmDialog>
<p-toast></p-toast>
<div class="main-content v-pB2">
    <div class="row">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <h5 class="title">
                        <b>Edit Profile</b>
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="p-field v-w33">
                            <label for="email">Email</label>
                            <input
                                id="email"
                                type="email"
                                aria-describedby="email-help"
                                [disabled]="true"
                                pInputText
                                [(ngModel)]="profile.email"
                            >
                            <!-- <small id="username2-help" class="p-invalid">Username is not available.</small> -->
                        </div>
                        <div class="p-field v-w33">
                            <label for="firstname">Name</label>
                            <input
                                id="name"
                                type="username"
                                aria-describedby="firstName-help"
                                class
                                pInputText
                                [(ngModel)]="profile.name"
                            >
                            <!-- <small id="username2-help" class="p-invalid">Username is not available.</small> -->
                        </div>
                        <div class="p-field v-w25 v-flex-custom">
                            <label
                                for="lastname"
                                class="v-gender"
                            >
                                Gender:
                            </label>
                            <!-- Material inline 1 -->
                            <div class="v-flex-1">
                                <div class="form-check form-check-inline">
                                    <input
                                        type="radio"
                                        class="form-check-input"
                                        id="materialInline1"
                                        name="inlineMaterialRadiosExample"
                                        mdbInput
                                        [checked]="profile.gender === 1 ? true : false"
                                        (change)="selectMale($event)"
                                    >
                                    <label
                                        class="form-check-label v-font-18px"
                                        for="materialInline1"
                                    >
                                        Male
                                    </label>
                                </div>

                                <!-- Material inline 2 -->
                                <div class="form-check form-check-inline">
                                    <input
                                        type="radio"
                                        class="form-check-input"
                                        id="materialInline2"
                                        name="inlineMaterialRadiosExample"
                                        mdbInput
                                        [checked]="profile.gender === 0 ? true : false"
                                        (change)="selectFemale($event)"
                                    >
                                    <label
                                        class="form-check-label v-font-18px"
                                        for="materialInline2"
                                    >
                                        Female
                                    </label>
                                </div>
                            </div>
                            <!-- <small id="username2-help" class="p-invalid">Username is not available.</small> -->
                        </div>
                    </div>

                    <div class="row v-mT-25px">
                        <div class="p-field v-w33">
                            <label for="icon">Date of birth:</label>
                            <p-calendar
                                [(ngModel)]="profile.date_of_birth"
                                [placeholder]="'dd/MM/yyyy'"
                                [showIcon]="true"
                                inputId="icon"
                                dateFormat="dd/mm/yy"
                                (onSelect)="onChangeTime($event)"
                            >
                            {{profile.date_of_birth}}
                          </p-calendar>
                        </div>
                        <div class="v-w62-custom">
                            <label for="icon">Address:</label>
                            <div class="v-flex">
                                <p-dropdown
                                    [options]="listCity"
                                    [(ngModel)]="selectedCity"
                                    (onChange)="selectCity()"
                                    placeholder="Select a City"
                                    optionLabel="name"
                                    [showClear]="true"
                                    [filter]="true"
                                    class="v-city"
                                >
                                    <ng-template pTemplate="selectedItem">
                                        <div
                                            class="country-item country-item-value"
                                            *ngIf="selectedCity"
                                        >
                                            <div>{{selectedCity.name}}</div>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                                <p-dropdown
                                    [options]="listDistrict"
                                    [(ngModel)]="selectedDistrict"
                                    (onChange)="selectDistrict()"
                                    placeholder="Select a District"
                                    optionLabel="name"
                                    [showClear]="true"
                                    [filter]="true"
                                    class="v-city"
                                >
                                    <ng-template pTemplate="selectedItem">
                                        <div
                                            class="country-item country-item-value"
                                            *ngIf="selectedDistrict"
                                        >
                                            <div>{{selectedDistrict.name}}</div>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                                <p-dropdown
                                    [options]="listWard"
                                    [(ngModel)]="selectedWard"
                                    placeholder="Select a Ward"
                                    optionLabel="name"
                                    (onChange)="selectWard()"
                                    [showClear]="true"
                                    [filter]="true"
                                    class="v-city"
                                >
                                    <ng-template pTemplate="selectedItem">
                                        <div
                                            class="country-item country-item-value"
                                            *ngIf="selectedWard"
                                        >
                                            <div>{{selectedWard.name}}</div>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                            </div>
                        </div>
                    </div>

                    <div class="row v-mT-25px">
                        <div class="p-field v-w33">
                            <label for="phone">Phone Number</label>
                            <input
                                id="phone"
                                type="phone"
                                aria-describedby="phone-help"
                                pInputText
                                [(ngModel)]="profile.phonenumber"
                                pattern="[0-9]{10}"
                            >
                            <!-- <small id="username2-help" class="p-invalid">Username is not available.</small> -->
                        </div>

                        <div class="p-field v-w20 v-flxEnd">
                            <button
                                type="button"
                                (click)="saveProfile()"
                            >
                                Save Info
                            </button>
                        </div>
                    </div>

                </div>
            </div>
            <div class="card v-mT-25px v-mB-25px">
                <div class="card-header">
                    <h5 class="title">
                        <b>Change Password</b>
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="p-field v-w25">
                            <label for="phone">Current Password:</label>
                            <input
                                type="password"
                                pPassword
                                [(ngModel)]="currentPass"
                                (focus)="this.submitted = false;"
                                autocomplete="false"
                            >
                            <small
                              class="p-invalid"
                              *ngIf="!currentPass && submitted"
                            >
                            Current password is required.
                            </small>
                        </div>
                        <div class="p-field v-w25">
                            <label for="phone">New Password:</label>
                            <input
                                type="password"
                                pPassword
                                [(ngModel)]="changePass"
                                (focus)="this.submitted = false;"
                            >
                            <small
                              class="p-invalid"
                              *ngIf="!changePass && submitted"
                            >
                            New passwrod is required.
                            </small>
                        </div>
                        <div class="p-field v-w25">
                            <label for="phone">Verify Password:</label>
                            <input
                                type="password"
                                pPassword
                                [(ngModel)]="verifyPass"
                                (focus)="this.submitted = false;"
                            >
                            <small
                              class="p-invalid"
                              *ngIf="verifyPass && changePass && changePass !== verifyPass"
                            >
                            The new password does not match the confirmation password.
                            </small>
                            <small
                              class="p-invalid"
                              *ngIf="!verifyPass && submitted"
                            >
                            Verify passwrod is required.
                            </small>
                        </div>
                        <div class="p-field v-w20 v-flxEnd">
                            <button
                                type="button"
                                (click)="savePass()"
                            >
                                Save Password
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card card-user">
                <div class="card-body">
                    <div class="author">
                        <div>
                            <div class="profile-picture">
                                <label
                                    class="hoverable"
                                    for="fileInput"
                                >
                                    <img [src]="profile.imgUrl ? profile.imgUrl : 'https://www.w3schools.com/howto/img_avatar.png'" class="v-img-admin">
                                    <div class="hover-text">Choose file</div>
                                    <div class="background"></div>
                                </label>
                                <br>
                                <input
                                    id="fileInput"
                                    type='file'
                                    (change)="onSelectFile($event)"
                                >
                                <button
                                    *ngIf="profile.imgUrl"
                                    (click)="deleteImage(profile.imgUrl)"
                                    class="v-del"
                                >
                                    Remove Image Profile
                                </button>
                            </div>
                        </div>
                        <div class="v-name">
                            <h4 class="title">{{profile.name}}</h4>
                            <!-- <p class="description">
                                <b>Email for Login:</b>
                                {{profile.email}}
                            </p> -->
                            <div class="description text-center v-mT1 v-txtL">
                              <div class="v-flex">
                                <div class="v-title">
                                  <b>Email for Login:</b>
                                </div>
                                <div class="v-info">
                                  {{profile.email}}
                                </div>
                              </div>
                              <div class="v-flex v-mT05">
                                <div class="v-title">
                                  <b>Gender:</b>
                                </div>
                                <div class="v-info">
                                  {{profile.gender === 1 ? 'Male' : 'Female'}}
                                </div>
                              </div>
                              <div class="v-flex v-mT05">
                                <div class="v-title">
                                  <b>Birthday:</b>
                                </div>
                                <div class="v-info">
                                  {{profile.date_of_birth}}
                                </div>
                              </div>
                              <div class="v-flex v-mT05">
                                <div class="v-title">
                                  <b>Address:</b>
                                </div>
                                <div class="v-info">
                                  {{formatAddress(profile.city, profile.district, profile.ward)}}
                                </div>
                              </div>
                              <div class="v-flex v-mT05">
                                <div class="v-title">
                                  <b>Phone:</b>
                                </div>
                                <div class="v-info">{{profile.phonenumber}}</div>
                              </div>
                            </div>
                        </div>
                    </div>
                </div>
                <hr>
                <div class="button-container">
                    <div class="v-mL1 v-help">Contact Us:</div>
                    <button
                        href="#"
                        class="btn btn-neutral btn-icon btn-round btn-lg v-mL2"
                    >
                        <i
                            class="fas fa-phone-alt"
                            href="tel:+840345920977"
                        ></i>
                    </button>
                    <button
                        href="#"
                        class="btn btn-neutral btn-icon btn-round btn-lg v-mL1"
                    >
                        <i
                            class="fas fa-envelope"
                            href="mailto:nguyenlevien0907@gmail.com"
                        ></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
